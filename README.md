# üöÄ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ —Ç—Ä—É–±–∞—Ö

–ê–ª–≥–æ—Ä–∏—Ç–º, –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–π—Ç–∏ –º–∞—Ä–∫–∏—Ä–æ–≤–∫—É –Ω–∞ —Ç—Ä—É–±–µ, —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞ –Ω–µ–π –∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø–æ–¥ –º–∞—Å–∫—É

---

# üìå –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
* [–û–ø–∏—Å–∞–Ω–∏–µ](#info)
* [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#use)
* [–ü—Ä–∏–º–µ—Ä](#example)
* [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#install)
* [–û—à–∏–±–∫–∏](#error)

---

<a id="info"></a>
# üìù –û–ø–∏—Å–∞–Ω–∏–µ
–ê–ª–≥–æ—Ä–∏—Ç–º, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞—ç–µ–Ω–∏–µ –≤ 4 —ç—Ç–∞–ø–ø–∞:
* –ü–æ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–µ–∑–∫–∞, —Å–≤–µ—Ä—Ö—É –∏ —Å–Ω–∏–∑—É
* –ü–æ–∏—Å–∫ —Ä–∞–º–∫–∏ —Å –ø–æ–º–æ—â—å—é YOLO
* –†–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é 0: base_ru 1: easy_ocr
* –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

---

<a id="use"></a>
# üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∏—Ç:
1. status - –û–±–æ–∑–Ω–∞—á–∞–µ—Ç –≤–æ–∑–Ω–∏–∫–ª–∏ –ª–∏ –∫–∞–∫–∏–µ-–Ω–∏–±—É–¥—å –æ—à–∏–±–∫–∏ –≤–æ –≤—Ä–µ–º—è —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è
2. mess - –í—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∏ –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∏
3. text - –¢–µ–∫—Å—Ç –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ OCR
4. marker - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
5. timer - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
6. color - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π –æ–±—Ä–µ–∑–∫–∏
7. corrected - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç ```dict()```, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–µ–∫—Å—Ç–µ, –∏–ª–∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–æ –¥–ª—è —á–µ–≥–æ –±—ã–ª–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∑–∞–º–µ–Ω–∞ –∏–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ Adding: –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ, Correction: –í–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä ```{'error_code': '003', 'error': ['Adding –¢–ú–ö', 'Correction –ß–¢–ü–ó']}```

---

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥:
* top - –ü—Ä–æ—Ü–µ–Ω—Ç –æ–±—Ä–µ–∑–∫–∏ –ø–æ –≤–≤–µ—Ä—Ö—É 0-1
* bottom - –ü—Ä–æ—Ü–µ–Ω—Ç –æ–±—Ä–µ–∑–∫–∏ –ø–æ –Ω–∏–∑—É 0-1
* pathModel - –ü—É—Ç—å –¥–æ YOLO –º–æ–¥–µ–ª–∏, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ files/model v2.pt
* pathOCR - –ü—É—Ç—å –¥–æ base_ocr, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ files/trocr-base-ru

```
record = Record(0.45, 0.35) # –°–æ–∫—Ä–∞—â—ë–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
record = Record(0.45, 0.35, r"files/model v2.pt", r"files/trocr-base-ru") # –ü–æ–ª–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
```

---

–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:
* input - –í—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
* numModel - –ù–æ–º–µ—Ä –º–æ–¥–µ–ª–∏ 0: base_ru 1: easy_ocr 
* structure - –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ —á—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞ –º–∞—Ä–∫–∏—Ä–æ–≤–∫–µ, –ø—Ä–∏–º–µ—Ä {"company": "–¢–ú–ö", "factory": "–ß–¢–ü–ó", "steel": "30–ì2"}

```status, mess, text, marker, timer, pred, corrected = record(frame, 0)```

---

<a id="example"></a>
# ‚ú® –ü—Ä–∏–º–µ—Ä

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ main.py, –ø—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ –≤ camera.py

``` main.py
from Recognition import Record
import cv2

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–µ–∫–æ–¥–µ—Ä
record = Record(0.45, 0.35)

# –û—Ç–∫—Ä—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
img = cv2.imread("img.jpg")

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–∞—Ä–∫–∏—Ä–æ–≤–∫—É
status, mess, _, marker, timer, _, _ = record(img, 0)

# –í—ã–≤–æ–¥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
if status:
    print(marker)
    print(timer, " —Å–µ–∫.")
else: print(mess)
```

---

<a id="install"></a>
# ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
git clone https://github.com/ByVladislav/MarkingRecognition.git
cd MarkingRecognition
pip install -r requirements.txt
```

---

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å trocr-base-ru, –ø–æ –ø—É—Ç—é MarkingRecognition/files/trocr-base-ru

–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: https://huggingface.co/raxtemur/trocr-base-ru/tree/main

---

–í —Ñ–∞–π–ª–µ **MarkingRecognition\.venv\Lib\site-packages\easyocr\utils.py** –≤ —Å—Ç—Ä–æ—á–∫–µ 582 –∏—Å–ø—Ä–∞–≤–∏—Ç—å ```maximum_y,maximum_x = img.shape``` –Ω–∞ ```maximum_y,maximum_x, _ = img.shape```

---

<a id="error"></a>
# üìé –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

* ```{"error_code":"001", "error":"Not detecting marking"}``` - –û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–≥–æ —á—Ç–æ –º–æ–¥–µ–ª—å YOLO –Ω–µ –Ω–∞—à–ª–∞ —Ä–∞–º–∫—É
* ```{"error_code":"002", "error":"Unable to find pipe number"}``` - –û–±–æ–∑–Ω–∞—á–∞–µ—Ç —Ç–æ —á—Ç–æ –ø—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –Ω–æ–º–µ—Ä —Ç—Ä—É–±—ã
* ```{'error_code': '003', 'error': ['Adding –¢–ú–ö', 'Correction –ß–¢–ü–ó']}``` - –û–±–æ–∑–Ω–∞—á–∞–µ—Ç –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤ –ø—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞

---
